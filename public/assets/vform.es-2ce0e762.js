import{d as m}from"./index-e0b9de87.js";var j=Object.defineProperty;var O=Object.prototype.hasOwnProperty;var d=Object.getOwnPropertySymbols;var A=Object.prototype.propertyIsEnumerable;var f=(e,s,t)=>s in e?j(e,s,{enumerable:true,configurable:true,writable:true,value:t}):e[s]=t;var a=(e,s)=>{for(var t in s||(s={}))O.call(s,t)&&f(e,t,s[t]);if(d)for(var t of d(s))A.call(s,t)&&f(e,t,s[t]);return e};const l=e=>void 0===e;const p=e=>Array.isArray(e);const y=e=>e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.slice;const u=(e,s,t,o)=>((s=s||{}).indices=!l(s.indices)&&s.indices,s.nullsAsUndefineds=!l(s.nullsAsUndefineds)&&s.nullsAsUndefineds,s.booleansAsIntegers=!l(s.booleansAsIntegers)&&s.booleansAsIntegers,s.allowEmptyArrays=!l(s.allowEmptyArrays)&&s.allowEmptyArrays,t=t||new FormData,l(e)||(null===e?s.nullsAsUndefineds||t.append(o,""):(r=>"boolean"==typeof r)(e)?s.booleansAsIntegers?t.append(o,e?1:0):t.append(o,e):p(e)?e.length?e.forEach((r,n)=>{const c=o+"["+(s.indices?n:"")+"]";u(r,s,t,c)}):s.allowEmptyArrays&&t.append(o+"[]",""):(r=>r instanceof Date)(e)?t.append(o,e.toISOString()):!(r=>r===Object(r))(e)||(r=>y(r)&&"string"==typeof r.name&&("object"==typeof r.lastModifiedDate||"number"==typeof r.lastModified))(e)||y(e)?t.append(o,e):Object.keys(e).forEach(r=>{const n=e[r];if(p(n))for(;r.length>2&&r.lastIndexOf("[]")===r.length-2;)r=r.substring(0,r.length-2);u(n,s,t,o?o+"["+r+"]":r)})),t);var w={serialize:u};function h(e){if(null===e||"object"!=typeof e)return e;const s=Array.isArray(e)?[]:{};return Object.keys(e).forEach(t=>{s[t]=h(e[t])}),s}function b(e){return Array.isArray(e)?e:[e]}function g(e){return e instanceof File||e instanceof Blob||e instanceof FileList||"object"==typeof e&&null!==e&&void 0!==Object.values(e).find(s=>g(s))}class E{constructor(){this.errors={},this.errors={}}set(s,t){"object"==typeof s?this.errors=s:this.set(a(a({},this.errors),{[s]:b(t)}))}all(){return this.errors}has(s){return Object.prototype.hasOwnProperty.call(this.errors,s)}hasAny(...s){return s.some(t=>this.has(t))}any(){return Object.keys(this.errors).length>0}get(s){if(this.has(s))return this.getAll(s)[0]}getAll(s){return b(this.errors[s]||[])}only(...s){const t=[];return s.forEach(o=>{const r=this.get(o);r&&t.push(r)}),t}flatten(){return Object.values(this.errors).reduce((s,t)=>s.concat(t),[])}clear(s){const t={};s&&Object.keys(this.errors).forEach(o=>{o!==s&&(t[o]=this.errors[o])}),this.set(t)}}class i{constructor(s={}){this.originalData={},this.busy=false,this.successful=false,this.recentlySuccessful=false,this.recentlySuccessfulTimeoutId=void 0,this.errors=new E,this.progress=void 0,this.update(s)}static make(s){return new this(s)}update(s){this.originalData=Object.assign({},this.originalData,h(s)),Object.assign(this,s)}fill(s={}){this.keys().forEach(t=>{this[t]=s[t]})}data(){return this.keys().reduce((s,t)=>a(a({},s),{[t]:this[t]}),{})}keys(){return Object.keys(this).filter(s=>!i.ignore.includes(s))}startProcessing(){this.errors.clear(),this.busy=true,this.successful=false,this.progress=void 0,this.recentlySuccessful=false,clearTimeout(this.recentlySuccessfulTimeoutId)}finishProcessing(){this.busy=false,this.successful=true,this.progress=void 0,this.recentlySuccessful=true,this.recentlySuccessfulTimeoutId=setTimeout(()=>{this.recentlySuccessful=false},i.recentlySuccessfulTimeout)}clear(){this.errors.clear(),this.successful=false,this.recentlySuccessful=false,this.progress=void 0,clearTimeout(this.recentlySuccessfulTimeoutId)}reset(){Object.keys(this).filter(s=>!i.ignore.includes(s)).forEach(s=>{this[s]=h(this.originalData[s])})}get(s,t={}){return this.submit("get",s,t)}post(s,t={}){return this.submit("post",s,t)}patch(s,t={}){return this.submit("patch",s,t)}put(s,t={}){return this.submit("put",s,t)}delete(s,t={}){return this.submit("delete",s,t)}submit(s,t,o={}){return this.startProcessing(),o=a({data:{},params:{},url:this.route(t),method:s,onUploadProgress:this.handleUploadProgress.bind(this)},o),"get"===s.toLowerCase()?o.params=a(a({},this.data()),o.params):(o.data=a(a({},this.data()),o.data),g(o.data)&&!o.transformRequest&&(o.transformRequest=[r=>w.serialize(r)])),new Promise((r,n)=>{(i.axios||m).request(o).then(c=>{this.finishProcessing(),r(c)}).catch(c=>{this.handleErrors(c),n(c)})})}handleErrors(s){this.busy=false,this.progress=void 0,s.response&&this.errors.set(this.extractErrors(s.response))}extractErrors(s){return s.data&&"object"==typeof s.data?s.data.errors?a({},s.data.errors):s.data.message?{error:s.data.message}:a({},s.data):{error:i.errorMessage}}handleUploadProgress(s){this.progress={total:s.total,loaded:s.loaded,percentage:Math.round(100*s.loaded/s.total)}}route(s,t={}){let o=s;return Object.prototype.hasOwnProperty.call(i.routes,s)&&(o=decodeURI(i.routes[s])),"object"!=typeof t&&(t={id:t}),Object.keys(t).forEach(r=>{o=o.replace(`{${r}}`,t[r])}),o}onKeydown(s){const t=s.target;t.name&&this.errors.clear(t.name)}}i.routes={},i.errorMessage="Something went wrong. Please try again.",i.recentlySuccessfulTimeout=2e3,i.ignore=["busy","successful","errors","progress","originalData","recentlySuccessful","recentlySuccessfulTimeoutId"];export{i as g};
